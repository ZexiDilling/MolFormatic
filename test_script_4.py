import configparser
import os.path

from bio_data_functions import multiscan_data_dict, xls_converter, csv_converter
from bio_functions import bio_compound_info_from_worklist
from file_handler import get_file_list
from bio_data_procul import data_controller, _translate_dict_generator
from bio_data_procul_report import procul_report_controller


def testing():
    config = configparser.ConfigParser()
    config.read("config.ini")
    folder = r"C:\Users\phch\OneDrive - Danmarks Tekniske Universitet\Mapper\Python_data\procul\raw"
    plate_layout = {1: {'group': 0, 'well_id': 'A1', 'state': 'blank', 'colour': '#7ebfc2'}, 2: {'group': 0, 'well_id': 'B1', 'state': 'blank', 'colour': '#7ebfc2'}, 3: {'group': 0, 'well_id': 'C1', 'state': 'blank', 'colour': '#7ebfc2'}, 4: {'group': 0, 'well_id': 'D1', 'state': 'blank', 'colour': '#7ebfc2'}, 5: {'group': 0, 'well_id': 'E1', 'state': 'blank', 'colour': '#7ebfc2'}, 6: {'group': 0, 'well_id': 'F1', 'state': 'blank', 'colour': '#7ebfc2'}, 7: {'group': 0, 'well_id': 'G1', 'state': 'blank', 'colour': '#7ebfc2'}, 8: {'group': 0, 'well_id': 'H1', 'state': 'blank', 'colour': '#7ebfc2'}, 9: {'group': 0, 'well_id': 'I1', 'state': 'blank', 'colour': '#7ebfc2'}, 10: {'group': 0, 'well_id': 'J1', 'state': 'blank', 'colour': '#7ebfc2'}, 11: {'group': 0, 'well_id': 'K1', 'state': 'blank', 'colour': '#7ebfc2'}, 12: {'group': 0, 'well_id': 'L1', 'state': 'blank', 'colour': '#7ebfc2'}, 13: {'group': 0, 'well_id': 'M1', 'state': 'blank', 'colour': '#7ebfc2'}, 14: {'group': 0, 'well_id': 'N1', 'state': 'blank', 'colour': '#7ebfc2'}, 15: {'group': 0, 'well_id': 'O1', 'state': 'blank', 'colour': '#7ebfc2'}, 16: {'group': 0, 'well_id': 'P1', 'state': 'blank', 'colour': '#7ebfc2'}, 17: {'group': 0, 'well_id': 'A2', 'state': 'blank', 'colour': '#7ebfc2'}, 18: {'group': 0, 'well_id': 'B2', 'state': 'blank', 'colour': '#7ebfc2'}, 19: {'group': 0, 'well_id': 'C2', 'state': 'blank', 'colour': '#7ebfc2'}, 20: {'group': 0, 'well_id': 'D2', 'state': 'blank', 'colour': '#7ebfc2'}, 21: {'group': 0, 'well_id': 'E2', 'state': 'blank', 'colour': '#7ebfc2'}, 22: {'group': 0, 'well_id': 'F2', 'state': 'blank', 'colour': '#7ebfc2'}, 23: {'group': 0, 'well_id': 'G2', 'state': 'blank', 'colour': '#7ebfc2'}, 24: {'group': 0, 'well_id': 'H2', 'state': 'blank', 'colour': '#7ebfc2'}, 25: {'group': 0, 'well_id': 'I2', 'state': 'blank', 'colour': '#7ebfc2'}, 26: {'group': 0, 'well_id': 'J2', 'state': 'blank', 'colour': '#7ebfc2'}, 27: {'group': 0, 'well_id': 'K2', 'state': 'blank', 'colour': '#7ebfc2'}, 28: {'group': 0, 'well_id': 'L2', 'state': 'blank', 'colour': '#7ebfc2'}, 29: {'group': 0, 'well_id': 'M2', 'state': 'blank', 'colour': '#7ebfc2'}, 30: {'group': 0, 'well_id': 'N2', 'state': 'blank', 'colour': '#7ebfc2'}, 31: {'group': 0, 'well_id': 'O2', 'state': 'blank', 'colour': '#7ebfc2'}, 32: {'group': 0, 'well_id': 'P2', 'state': 'blank', 'colour': '#7ebfc2'}, 33: {'group': 0, 'well_id': 'A3', 'state': 'blank', 'colour': '#7ebfc2'}, 34: {'group': 0, 'well_id': 'B3', 'state': 'blank', 'colour': '#7ebfc2'}, 35: {'group': '1', 'well_id': 'C3', 'state': 'positive', 'colour': '#09ca0e'}, 36: {'group': 0, 'well_id': 'D3', 'state': 'blank', 'colour': '#7ebfc2'}, 37: {'group': 0, 'well_id': 'E3', 'state': 'blank', 'colour': '#7ebfc2'}, 38: {'group': 0, 'well_id': 'F3', 'state': 'blank', 'colour': '#7ebfc2'}, 39: {'group': 0, 'well_id': 'G3', 'state': 'blank', 'colour': '#7ebfc2'}, 40: {'group': 0, 'well_id': 'H3', 'state': 'blank', 'colour': '#7ebfc2'}, 41: {'group': 0, 'well_id': 'I3', 'state': 'blank', 'colour': '#7ebfc2'}, 42: {'group': 0, 'well_id': 'J3', 'state': 'blank', 'colour': '#7ebfc2'}, 43: {'group': 0, 'well_id': 'K3', 'state': 'blank', 'colour': '#7ebfc2'}, 44: {'group': 0, 'well_id': 'L3', 'state': 'blank', 'colour': '#7ebfc2'}, 45: {'group': '10', 'well_id': 'M3', 'state': 'positive', 'colour': '#09ca0e'}, 46: {'group': 0, 'well_id': 'N3', 'state': 'blank', 'colour': '#7ebfc2'}, 47: {'group': 0, 'well_id': 'O3', 'state': 'blank', 'colour': '#7ebfc2'}, 48: {'group': 0, 'well_id': 'P3', 'state': 'negative', 'colour': '#d20000'}, 49: {'group': 0, 'well_id': 'A4', 'state': 'blank', 'colour': '#7ebfc2'}, 50: {'group': 0, 'well_id': 'B4', 'state': 'blank', 'colour': '#7ebfc2'}, 51: {'group': 0, 'well_id': 'C4', 'state': 'blank', 'colour': '#7ebfc2'}, 52: {'group': 0, 'well_id': 'D4', 'state': 'blank', 'colour': '#7ebfc2'}, 53: {'group': 0, 'well_id': 'E4', 'state': 'blank', 'colour': '#7ebfc2'}, 54: {'group': 0, 'well_id': 'F4', 'state': 'blank', 'colour': '#7ebfc2'}, 55: {'group': '12', 'well_id': 'G4', 'state': 'positive', 'colour': '#09ca0e'}, 56: {'group': 0, 'well_id': 'H4', 'state': 'blank', 'colour': '#7ebfc2'}, 57: {'group': 0, 'well_id': 'I4', 'state': 'blank', 'colour': '#7ebfc2'}, 58: {'group': 0, 'well_id': 'J4', 'state': 'blank', 'colour': '#7ebfc2'}, 59: {'group': 0, 'well_id': 'K4', 'state': 'blank', 'colour': '#7ebfc2'}, 60: {'group': 0, 'well_id': 'L4', 'state': 'blank', 'colour': '#7ebfc2'}, 61: {'group': 0, 'well_id': 'M4', 'state': 'blank', 'colour': '#7ebfc2'}, 62: {'group': 0, 'well_id': 'N4', 'state': 'blank', 'colour': '#7ebfc2'}, 63: {'group': 0, 'well_id': 'O4', 'state': 'blank', 'colour': '#7ebfc2'}, 64: {'group': 0, 'well_id': 'P4', 'state': 'blank', 'colour': '#7ebfc2'}, 65: {'group': 0, 'well_id': 'A5', 'state': 'negative', 'colour': '#d20000'}, 66: {'group': 0, 'well_id': 'B5', 'state': 'blank', 'colour': '#7ebfc2'}, 67: {'group': 0, 'well_id': 'C5', 'state': 'blank', 'colour': '#7ebfc2'}, 68: {'group': 0, 'well_id': 'D5', 'state': 'blank', 'colour': '#7ebfc2'}, 69: {'group': 0, 'well_id': 'E5', 'state': 'blank', 'colour': '#7ebfc2'}, 70: {'group': 0, 'well_id': 'F5', 'state': 'blank', 'colour': '#7ebfc2'}, 71: {'group': 0, 'well_id': 'G5', 'state': 'blank', 'colour': '#7ebfc2'}, 72: {'group': 0, 'well_id': 'H5', 'state': 'blank', 'colour': '#7ebfc2'}, 73: {'group': 0, 'well_id': 'I5', 'state': 'blank', 'colour': '#7ebfc2'}, 74: {'group': 0, 'well_id': 'J5', 'state': 'blank', 'colour': '#7ebfc2'}, 75: {'group': 0, 'well_id': 'K5', 'state': 'blank', 'colour': '#7ebfc2'}, 76: {'group': 0, 'well_id': 'L5', 'state': 'blank', 'colour': '#7ebfc2'}, 77: {'group': 0, 'well_id': 'M5', 'state': 'blank', 'colour': '#7ebfc2'}, 78: {'group': 0, 'well_id': 'N5', 'state': 'blank', 'colour': '#7ebfc2'}, 79: {'group': 0, 'well_id': 'O5', 'state': 'blank', 'colour': '#7ebfc2'}, 80: {'group': 0, 'well_id': 'P5', 'state': 'blank', 'colour': '#7ebfc2'}, 81: {'group': 0, 'well_id': 'A6', 'state': 'blank', 'colour': '#7ebfc2'}, 82: {'group': 0, 'well_id': 'B6', 'state': 'blank', 'colour': '#7ebfc2'}, 83: {'group': 0, 'well_id': 'C6', 'state': 'blank', 'colour': '#7ebfc2'}, 84: {'group': 0, 'well_id': 'D6', 'state': 'blank', 'colour': '#7ebfc2'}, 85: {'group': 0, 'well_id': 'E6', 'state': 'blank', 'colour': '#7ebfc2'}, 86: {'group': 0, 'well_id': 'F6', 'state': 'blank', 'colour': '#7ebfc2'}, 87: {'group': 0, 'well_id': 'G6', 'state': 'blank', 'colour': '#7ebfc2'}, 88: {'group': 0, 'well_id': 'H6', 'state': 'blank', 'colour': '#7ebfc2'}, 89: {'group': 0, 'well_id': 'I6', 'state': 'blank', 'colour': '#7ebfc2'}, 90: {'group': 0, 'well_id': 'J6', 'state': 'blank', 'colour': '#7ebfc2'}, 91: {'group': 0, 'well_id': 'K6', 'state': 'negative', 'colour': '#d20000'}, 92: {'group': 0, 'well_id': 'L6', 'state': 'blank', 'colour': '#7ebfc2'}, 93: {'group': 0, 'well_id': 'M6', 'state': 'blank', 'colour': '#7ebfc2'}, 94: {'group': 0, 'well_id': 'N6', 'state': 'blank', 'colour': '#7ebfc2'}, 95: {'group': 0, 'well_id': 'O6', 'state': 'blank', 'colour': '#7ebfc2'}, 96: {'group': 0, 'well_id': 'P6', 'state': 'blank', 'colour': '#7ebfc2'}, 97: {'group': 0, 'well_id': 'A7', 'state': 'blank', 'colour': '#7ebfc2'}, 98: {'group': 0, 'well_id': 'B7', 'state': 'blank', 'colour': '#7ebfc2'}, 99: {'group': 0, 'well_id': 'C7', 'state': 'blank', 'colour': '#7ebfc2'}, 100: {'group': 0, 'well_id': 'D7', 'state': 'blank', 'colour': '#7ebfc2'}, 101: {'group': 0, 'well_id': 'E7', 'state': 'blank', 'colour': '#7ebfc2'}, 102: {'group': 0, 'well_id': 'F7', 'state': 'blank', 'colour': '#7ebfc2'}, 103: {'group': 0, 'well_id': 'G7', 'state': 'blank', 'colour': '#7ebfc2'}, 104: {'group': 0, 'well_id': 'H7', 'state': 'blank', 'colour': '#7ebfc2'}, 105: {'group': 0, 'well_id': 'I7', 'state': 'blank', 'colour': '#7ebfc2'}, 106: {'group': 0, 'well_id': 'J7', 'state': 'blank', 'colour': '#7ebfc2'}, 107: {'group': 0, 'well_id': 'K7', 'state': 'blank', 'colour': '#7ebfc2'}, 108: {'group': 0, 'well_id': 'L7', 'state': 'blank', 'colour': '#7ebfc2'}, 109: {'group': 0, 'well_id': 'M7', 'state': 'blank', 'colour': '#7ebfc2'}, 110: {'group': 0, 'well_id': 'N7', 'state': 'blank', 'colour': '#7ebfc2'}, 111: {'group': 0, 'well_id': 'O7', 'state': 'blank', 'colour': '#7ebfc2'}, 112: {'group': 0, 'well_id': 'P7', 'state': 'blank', 'colour': '#7ebfc2'}, 113: {'group': 0, 'well_id': 'A8', 'state': 'blank', 'colour': '#7ebfc2'}, 114: {'group': 0, 'well_id': 'B8', 'state': 'blank', 'colour': '#7ebfc2'}, 115: {'group': 0, 'well_id': 'C8', 'state': 'blank', 'colour': '#7ebfc2'}, 116: {'group': 0, 'well_id': 'D8', 'state': 'blank', 'colour': '#7ebfc2'}, 117: {'group': 0, 'well_id': 'E8', 'state': 'blank', 'colour': '#7ebfc2'}, 118: {'group': 0, 'well_id': 'F8', 'state': 'blank', 'colour': '#7ebfc2'}, 119: {'group': 0, 'well_id': 'G8', 'state': 'blank', 'colour': '#7ebfc2'}, 120: {'group': 0, 'well_id': 'H8', 'state': 'blank', 'colour': '#7ebfc2'}, 121: {'group': 0, 'well_id': 'I8', 'state': 'blank', 'colour': '#7ebfc2'}, 122: {'group': 0, 'well_id': 'J8', 'state': 'blank', 'colour': '#7ebfc2'}, 123: {'group': 0, 'well_id': 'K8', 'state': 'blank', 'colour': '#7ebfc2'}, 124: {'group': 0, 'well_id': 'L8', 'state': 'blank', 'colour': '#7ebfc2'}, 125: {'group': 0, 'well_id': 'M8', 'state': 'blank', 'colour': '#7ebfc2'}, 126: {'group': 0, 'well_id': 'N8', 'state': 'blank', 'colour': '#7ebfc2'}, 127: {'group': 0, 'well_id': 'O8', 'state': 'blank', 'colour': '#7ebfc2'}, 128: {'group': '5', 'well_id': 'P8', 'state': 'positive', 'colour': '#09ca0e'}, 129: {'group': 0, 'well_id': 'A9', 'state': 'blank', 'colour': '#7ebfc2'}, 130: {'group': 0, 'well_id': 'B9', 'state': 'blank', 'colour': '#7ebfc2'}, 131: {'group': 0, 'well_id': 'C9', 'state': 'blank', 'colour': '#7ebfc2'}, 132: {'group': 0, 'well_id': 'D9', 'state': 'blank', 'colour': '#7ebfc2'}, 133: {'group': 0, 'well_id': 'E9', 'state': 'blank', 'colour': '#7ebfc2'}, 134: {'group': 0, 'well_id': 'F9', 'state': 'blank', 'colour': '#7ebfc2'}, 135: {'group': 0, 'well_id': 'G9', 'state': 'blank', 'colour': '#7ebfc2'}, 136: {'group': 0, 'well_id': 'H9', 'state': 'blank', 'colour': '#7ebfc2'}, 137: {'group': 0, 'well_id': 'I9', 'state': 'blank', 'colour': '#7ebfc2'}, 138: {'group': 0, 'well_id': 'J9', 'state': 'blank', 'colour': '#7ebfc2'}, 139: {'group': 0, 'well_id': 'K9', 'state': 'blank', 'colour': '#7ebfc2'}, 140: {'group': 0, 'well_id': 'L9', 'state': 'blank', 'colour': '#7ebfc2'}, 141: {'group': 0, 'well_id': 'M9', 'state': 'blank', 'colour': '#7ebfc2'}, 142: {'group': 0, 'well_id': 'N9', 'state': 'blank', 'colour': '#7ebfc2'}, 143: {'group': 0, 'well_id': 'O9', 'state': 'blank', 'colour': '#7ebfc2'}, 144: {'group': 0, 'well_id': 'P9', 'state': 'blank', 'colour': '#7ebfc2'}, 145: {'group': 0, 'well_id': 'A10', 'state': 'blank', 'colour': '#7ebfc2'}, 146: {'group': '6', 'well_id': 'B10', 'state': 'positive', 'colour': '#09ca0e'}, 147: {'group': 0, 'well_id': 'C10', 'state': 'blank', 'colour': '#7ebfc2'}, 148: {'group': 0, 'well_id': 'D10', 'state': 'blank', 'colour': '#7ebfc2'}, 149: {'group': 0, 'well_id': 'E10', 'state': 'negative', 'colour': '#d20000'}, 150: {'group': 0, 'well_id': 'F10', 'state': 'blank', 'colour': '#7ebfc2'}, 151: {'group': 0, 'well_id': 'G10', 'state': 'blank', 'colour': '#7ebfc2'}, 152: {'group': 0, 'well_id': 'H10', 'state': 'blank', 'colour': '#7ebfc2'}, 153: {'group': '4', 'well_id': 'I10', 'state': 'positive', 'colour': '#09ca0e'}, 154: {'group': 0, 'well_id': 'J10', 'state': 'blank', 'colour': '#7ebfc2'}, 155: {'group': 0, 'well_id': 'K10', 'state': 'blank', 'colour': '#7ebfc2'}, 156: {'group': 0, 'well_id': 'L10', 'state': 'blank', 'colour': '#7ebfc2'}, 157: {'group': 0, 'well_id': 'M10', 'state': 'blank', 'colour': '#7ebfc2'}, 158: {'group': 0, 'well_id': 'N10', 'state': 'blank', 'colour': '#7ebfc2'}, 159: {'group': 0, 'well_id': 'O10', 'state': 'blank', 'colour': '#7ebfc2'}, 160: {'group': 0, 'well_id': 'P10', 'state': 'blank', 'colour': '#7ebfc2'}, 161: {'group': 0, 'well_id': 'A11', 'state': 'blank', 'colour': '#7ebfc2'}, 162: {'group': 0, 'well_id': 'B11', 'state': 'blank', 'colour': '#7ebfc2'}, 163: {'group': 0, 'well_id': 'C11', 'state': 'blank', 'colour': '#7ebfc2'}, 164: {'group': 0, 'well_id': 'D11', 'state': 'blank', 'colour': '#7ebfc2'}, 165: {'group': 0, 'well_id': 'E11', 'state': 'blank', 'colour': '#7ebfc2'}, 166: {'group': 0, 'well_id': 'F11', 'state': 'blank', 'colour': '#7ebfc2'}, 167: {'group': 0, 'well_id': 'G11', 'state': 'blank', 'colour': '#7ebfc2'}, 168: {'group': 0, 'well_id': 'H11', 'state': 'blank', 'colour': '#7ebfc2'}, 169: {'group': 0, 'well_id': 'I11', 'state': 'blank', 'colour': '#7ebfc2'}, 170: {'group': 0, 'well_id': 'J11', 'state': 'blank', 'colour': '#7ebfc2'}, 171: {'group': 0, 'well_id': 'K11', 'state': 'blank', 'colour': '#7ebfc2'}, 172: {'group': 0, 'well_id': 'L11', 'state': 'blank', 'colour': '#7ebfc2'}, 173: {'group': 0, 'well_id': 'M11', 'state': 'blank', 'colour': '#7ebfc2'}, 174: {'group': 0, 'well_id': 'N11', 'state': 'blank', 'colour': '#7ebfc2'}, 175: {'group': 0, 'well_id': 'O11', 'state': 'blank', 'colour': '#7ebfc2'}, 176: {'group': 0, 'well_id': 'P11', 'state': 'blank', 'colour': '#7ebfc2'}, 177: {'group': 0, 'well_id': 'A12', 'state': 'blank', 'colour': '#7ebfc2'}, 178: {'group': 0, 'well_id': 'B12', 'state': 'blank', 'colour': '#7ebfc2'}, 179: {'group': 0, 'well_id': 'C12', 'state': 'blank', 'colour': '#7ebfc2'}, 180: {'group': 0, 'well_id': 'D12', 'state': 'blank', 'colour': '#7ebfc2'}, 181: {'group': 0, 'well_id': 'E12', 'state': 'blank', 'colour': '#7ebfc2'}, 182: {'group': 0, 'well_id': 'F12', 'state': 'blank', 'colour': '#7ebfc2'}, 183: {'group': 0, 'well_id': 'G12', 'state': 'blank', 'colour': '#7ebfc2'}, 184: {'group': 0, 'well_id': 'H12', 'state': 'blank', 'colour': '#7ebfc2'}, 185: {'group': 0, 'well_id': 'I12', 'state': 'blank', 'colour': '#7ebfc2'}, 186: {'group': 0, 'well_id': 'J12', 'state': 'blank', 'colour': '#7ebfc2'}, 187: {'group': 0, 'well_id': 'K12', 'state': 'blank', 'colour': '#7ebfc2'}, 188: {'group': 0, 'well_id': 'L12', 'state': 'blank', 'colour': '#7ebfc2'}, 189: {'group': 0, 'well_id': 'M12', 'state': 'negative', 'colour': '#d20000'}, 190: {'group': 0, 'well_id': 'N12', 'state': 'blank', 'colour': '#7ebfc2'}, 191: {'group': 0, 'well_id': 'O12', 'state': 'blank', 'colour': '#7ebfc2'}, 192: {'group': 0, 'well_id': 'P12', 'state': 'blank', 'colour': '#7ebfc2'}, 193: {'group': 0, 'well_id': 'A13', 'state': 'blank', 'colour': '#7ebfc2'}, 194: {'group': 0, 'well_id': 'B13', 'state': 'blank', 'colour': '#7ebfc2'}, 195: {'group': 0, 'well_id': 'C13', 'state': 'blank', 'colour': '#7ebfc2'}, 196: {'group': 0, 'well_id': 'D13', 'state': 'blank', 'colour': '#7ebfc2'}, 197: {'group': 0, 'well_id': 'E13', 'state': 'blank', 'colour': '#7ebfc2'}, 198: {'group': 0, 'well_id': 'F13', 'state': 'blank', 'colour': '#7ebfc2'}, 199: {'group': 0, 'well_id': 'G13', 'state': 'blank', 'colour': '#7ebfc2'}, 200: {'group': 0, 'well_id': 'H13', 'state': 'blank', 'colour': '#7ebfc2'}, 201: {'group': 0, 'well_id': 'I13', 'state': 'blank', 'colour': '#7ebfc2'}, 202: {'group': 0, 'well_id': 'J13', 'state': 'blank', 'colour': '#7ebfc2'}, 203: {'group': 0, 'well_id': 'K13', 'state': 'blank', 'colour': '#7ebfc2'}, 204: {'group': 0, 'well_id': 'L13', 'state': 'blank', 'colour': '#7ebfc2'}, 205: {'group': 0, 'well_id': 'M13', 'state': 'blank', 'colour': '#7ebfc2'}, 206: {'group': 0, 'well_id': 'N13', 'state': 'blank', 'colour': '#7ebfc2'}, 207: {'group': 0, 'well_id': 'O13', 'state': 'blank', 'colour': '#7ebfc2'}, 208: {'group': 0, 'well_id': 'P13', 'state': 'blank', 'colour': '#7ebfc2'}, 209: {'group': 0, 'well_id': 'A14', 'state': 'blank', 'colour': '#7ebfc2'}, 210: {'group': 0, 'well_id': 'B14', 'state': 'blank', 'colour': '#7ebfc2'}, 211: {'group': 0, 'well_id': 'C14', 'state': 'blank', 'colour': '#7ebfc2'}, 212: {'group': 0, 'well_id': 'D14', 'state': 'blank', 'colour': '#7ebfc2'}, 213: {'group': 0, 'well_id': 'E14', 'state': 'blank', 'colour': '#7ebfc2'}, 214: {'group': 0, 'well_id': 'F14', 'state': 'blank', 'colour': '#7ebfc2'}, 215: {'group': 0, 'well_id': 'G14', 'state': 'blank', 'colour': '#7ebfc2'}, 216: {'group': 0, 'well_id': 'H14', 'state': 'blank', 'colour': '#7ebfc2'}, 217: {'group': 0, 'well_id': 'I14', 'state': 'blank', 'colour': '#7ebfc2'}, 218: {'group': 0, 'well_id': 'J14', 'state': 'blank', 'colour': '#7ebfc2'}, 219: {'group': 0, 'well_id': 'K14', 'state': 'blank', 'colour': '#7ebfc2'}, 220: {'group': 0, 'well_id': 'L14', 'state': 'blank', 'colour': '#7ebfc2'}, 221: {'group': 0, 'well_id': 'M14', 'state': 'blank', 'colour': '#7ebfc2'}, 222: {'group': 0, 'well_id': 'N14', 'state': 'blank', 'colour': '#7ebfc2'}, 223: {'group': 0, 'well_id': 'O14', 'state': 'blank', 'colour': '#7ebfc2'}, 224: {'group': 0, 'well_id': 'P14', 'state': 'blank', 'colour': '#7ebfc2'}, 225: {'group': 0, 'well_id': 'A15', 'state': 'blank', 'colour': '#7ebfc2'}, 226: {'group': 0, 'well_id': 'B15', 'state': 'blank', 'colour': '#7ebfc2'}, 227: {'group': 0, 'well_id': 'C15', 'state': 'blank', 'colour': '#7ebfc2'}, 228: {'group': 0, 'well_id': 'D15', 'state': 'blank', 'colour': '#7ebfc2'}, 229: {'group': '3', 'well_id': 'E15', 'state': 'positive', 'colour': '#09ca0e'}, 230: {'group': 0, 'well_id': 'F15', 'state': 'blank', 'colour': '#7ebfc2'}, 231: {'group': 0, 'well_id': 'G15', 'state': 'blank', 'colour': '#7ebfc2'}, 232: {'group': 0, 'well_id': 'H15', 'state': 'blank', 'colour': '#7ebfc2'}, 233: {'group': 0, 'well_id': 'I15', 'state': 'blank', 'colour': '#7ebfc2'}, 234: {'group': 0, 'well_id': 'J15', 'state': 'blank', 'colour': '#7ebfc2'}, 235: {'group': 0, 'well_id': 'K15', 'state': 'blank', 'colour': '#7ebfc2'}, 236: {'group': 0, 'well_id': 'L15', 'state': 'blank', 'colour': '#7ebfc2'}, 237: {'group': 0, 'well_id': 'M15', 'state': 'blank', 'colour': '#7ebfc2'}, 238: {'group': 0, 'well_id': 'N15', 'state': 'blank', 'colour': '#7ebfc2'}, 239: {'group': 0, 'well_id': 'O15', 'state': 'blank', 'colour': '#7ebfc2'}, 240: {'group': 0, 'well_id': 'P15', 'state': 'blank', 'colour': '#7ebfc2'}, 241: {'group': 0, 'well_id': 'A16', 'state': 'blank', 'colour': '#7ebfc2'}, 242: {'group': 0, 'well_id': 'B16', 'state': 'blank', 'colour': '#7ebfc2'}, 243: {'group': 0, 'well_id': 'C16', 'state': 'blank', 'colour': '#7ebfc2'}, 244: {'group': 0, 'well_id': 'D16', 'state': 'blank', 'colour': '#7ebfc2'}, 245: {'group': 0, 'well_id': 'E16', 'state': 'blank', 'colour': '#7ebfc2'}, 246: {'group': 0, 'well_id': 'F16', 'state': 'blank', 'colour': '#7ebfc2'}, 247: {'group': 0, 'well_id': 'G16', 'state': 'negative', 'colour': '#d20000'}, 248: {'group': 0, 'well_id': 'H16', 'state': 'blank', 'colour': '#7ebfc2'}, 249: {'group': 0, 'well_id': 'I16', 'state': 'blank', 'colour': '#7ebfc2'}, 250: {'group': '8', 'well_id': 'J16', 'state': 'positive', 'colour': '#09ca0e'}, 251: {'group': 0, 'well_id': 'K16', 'state': 'blank', 'colour': '#7ebfc2'}, 252: {'group': 0, 'well_id': 'L16', 'state': 'blank', 'colour': '#7ebfc2'}, 253: {'group': 0, 'well_id': 'M16', 'state': 'blank', 'colour': '#7ebfc2'}, 254: {'group': 0, 'well_id': 'N16', 'state': 'blank', 'colour': '#7ebfc2'}, 255: {'group': 0, 'well_id': 'O16', 'state': 'blank', 'colour': '#7ebfc2'}, 256: {'group': 0, 'well_id': 'P16', 'state': 'blank', 'colour': '#7ebfc2'}, 257: {'group': 0, 'well_id': 'A17', 'state': 'blank', 'colour': '#7ebfc2'}, 258: {'group': 0, 'well_id': 'B17', 'state': 'blank', 'colour': '#7ebfc2'}, 259: {'group': 0, 'well_id': 'C17', 'state': 'blank', 'colour': '#7ebfc2'}, 260: {'group': 0, 'well_id': 'D17', 'state': 'blank', 'colour': '#7ebfc2'}, 261: {'group': 0, 'well_id': 'E17', 'state': 'blank', 'colour': '#7ebfc2'}, 262: {'group': 0, 'well_id': 'F17', 'state': 'blank', 'colour': '#7ebfc2'}, 263: {'group': 0, 'well_id': 'G17', 'state': 'blank', 'colour': '#7ebfc2'}, 264: {'group': 0, 'well_id': 'H17', 'state': 'blank', 'colour': '#7ebfc2'}, 265: {'group': 0, 'well_id': 'I17', 'state': 'blank', 'colour': '#7ebfc2'}, 266: {'group': 0, 'well_id': 'J17', 'state': 'blank', 'colour': '#7ebfc2'}, 267: {'group': 0, 'well_id': 'K17', 'state': 'blank', 'colour': '#7ebfc2'}, 268: {'group': 0, 'well_id': 'L17', 'state': 'blank', 'colour': '#7ebfc2'}, 269: {'group': 0, 'well_id': 'M17', 'state': 'blank', 'colour': '#7ebfc2'}, 270: {'group': '7', 'well_id': 'N17', 'state': 'positive', 'colour': '#09ca0e'}, 271: {'group': 0, 'well_id': 'O17', 'state': 'blank', 'colour': '#7ebfc2'}, 272: {'group': 0, 'well_id': 'P17', 'state': 'blank', 'colour': '#7ebfc2'}, 273: {'group': 0, 'well_id': 'A18', 'state': 'blank', 'colour': '#7ebfc2'}, 274: {'group': 0, 'well_id': 'B18', 'state': 'blank', 'colour': '#7ebfc2'}, 275: {'group': '11', 'well_id': 'C18', 'state': 'positive', 'colour': '#09ca0e'}, 276: {'group': 0, 'well_id': 'D18', 'state': 'blank', 'colour': '#7ebfc2'}, 277: {'group': 0, 'well_id': 'E18', 'state': 'blank', 'colour': '#7ebfc2'}, 278: {'group': 0, 'well_id': 'F18', 'state': 'blank', 'colour': '#7ebfc2'}, 279: {'group': 0, 'well_id': 'G18', 'state': 'blank', 'colour': '#7ebfc2'}, 280: {'group': 0, 'well_id': 'H18', 'state': 'blank', 'colour': '#7ebfc2'}, 281: {'group': 0, 'well_id': 'I18', 'state': 'blank', 'colour': '#7ebfc2'}, 282: {'group': 0, 'well_id': 'J18', 'state': 'blank', 'colour': '#7ebfc2'}, 283: {'group': 0, 'well_id': 'K18', 'state': 'blank', 'colour': '#7ebfc2'}, 284: {'group': 0, 'well_id': 'L18', 'state': 'blank', 'colour': '#7ebfc2'}, 285: {'group': 0, 'well_id': 'M18', 'state': 'blank', 'colour': '#7ebfc2'}, 286: {'group': 0, 'well_id': 'N18', 'state': 'blank', 'colour': '#7ebfc2'}, 287: {'group': 0, 'well_id': 'O18', 'state': 'blank', 'colour': '#7ebfc2'}, 288: {'group': 0, 'well_id': 'P18', 'state': 'blank', 'colour': '#7ebfc2'}, 289: {'group': 0, 'well_id': 'A19', 'state': 'blank', 'colour': '#7ebfc2'}, 290: {'group': 0, 'well_id': 'B19', 'state': 'blank', 'colour': '#7ebfc2'}, 291: {'group': 0, 'well_id': 'C19', 'state': 'blank', 'colour': '#7ebfc2'}, 292: {'group': 0, 'well_id': 'D19', 'state': 'blank', 'colour': '#7ebfc2'}, 293: {'group': 0, 'well_id': 'E19', 'state': 'blank', 'colour': '#7ebfc2'}, 294: {'group': 0, 'well_id': 'F19', 'state': 'blank', 'colour': '#7ebfc2'}, 295: {'group': 0, 'well_id': 'G19', 'state': 'blank', 'colour': '#7ebfc2'}, 296: {'group': 0, 'well_id': 'H19', 'state': 'blank', 'colour': '#7ebfc2'}, 297: {'group': 0, 'well_id': 'I19', 'state': 'blank', 'colour': '#7ebfc2'}, 298: {'group': 0, 'well_id': 'J19', 'state': 'blank', 'colour': '#7ebfc2'}, 299: {'group': 0, 'well_id': 'K19', 'state': 'blank', 'colour': '#7ebfc2'}, 300: {'group': 0, 'well_id': 'L19', 'state': 'blank', 'colour': '#7ebfc2'}, 301: {'group': 0, 'well_id': 'M19', 'state': 'blank', 'colour': '#7ebfc2'}, 302: {'group': 0, 'well_id': 'N19', 'state': 'blank', 'colour': '#7ebfc2'}, 303: {'group': 0, 'well_id': 'O19', 'state': 'blank', 'colour': '#7ebfc2'}, 304: {'group': 0, 'well_id': 'P19', 'state': 'blank', 'colour': '#7ebfc2'}, 305: {'group': 0, 'well_id': 'A20', 'state': 'blank', 'colour': '#7ebfc2'}, 306: {'group': 0, 'well_id': 'B20', 'state': 'blank', 'colour': '#7ebfc2'}, 307: {'group': 0, 'well_id': 'C20', 'state': 'blank', 'colour': '#7ebfc2'}, 308: {'group': 0, 'well_id': 'D20', 'state': 'blank', 'colour': '#7ebfc2'}, 309: {'group': 0, 'well_id': 'E20', 'state': 'blank', 'colour': '#7ebfc2'}, 310: {'group': 0, 'well_id': 'F20', 'state': 'blank', 'colour': '#7ebfc2'}, 311: {'group': 0, 'well_id': 'G20', 'state': 'blank', 'colour': '#7ebfc2'}, 312: {'group': 0, 'well_id': 'H20', 'state': 'blank', 'colour': '#7ebfc2'}, 313: {'group': 0, 'well_id': 'I20', 'state': 'blank', 'colour': '#7ebfc2'}, 314: {'group': 0, 'well_id': 'J20', 'state': 'blank', 'colour': '#7ebfc2'}, 315: {'group': 0, 'well_id': 'K20', 'state': 'blank', 'colour': '#7ebfc2'}, 316: {'group': 0, 'well_id': 'L20', 'state': 'blank', 'colour': '#7ebfc2'}, 317: {'group': 0, 'well_id': 'M20', 'state': 'blank', 'colour': '#7ebfc2'}, 318: {'group': 0, 'well_id': 'N20', 'state': 'blank', 'colour': '#7ebfc2'}, 319: {'group': 0, 'well_id': 'O20', 'state': 'blank', 'colour': '#7ebfc2'}, 320: {'group': 0, 'well_id': 'P20', 'state': 'blank', 'colour': '#7ebfc2'}, 321: {'group': 0, 'well_id': 'A21', 'state': 'blank', 'colour': '#7ebfc2'}, 322: {'group': 0, 'well_id': 'B21', 'state': 'blank', 'colour': '#7ebfc2'}, 323: {'group': 0, 'well_id': 'C21', 'state': 'blank', 'colour': '#7ebfc2'}, 324: {'group': 0, 'well_id': 'D21', 'state': 'blank', 'colour': '#7ebfc2'}, 325: {'group': 0, 'well_id': 'E21', 'state': 'blank', 'colour': '#7ebfc2'}, 326: {'group': '9', 'well_id': 'F21', 'state': 'positive', 'colour': '#09ca0e'}, 327: {'group': 0, 'well_id': 'G21', 'state': 'blank', 'colour': '#7ebfc2'}, 328: {'group': 0, 'well_id': 'H21', 'state': 'blank', 'colour': '#7ebfc2'}, 329: {'group': 0, 'well_id': 'I21', 'state': 'blank', 'colour': '#7ebfc2'}, 330: {'group': 0, 'well_id': 'J21', 'state': 'blank', 'colour': '#7ebfc2'}, 331: {'group': 0, 'well_id': 'K21', 'state': 'blank', 'colour': '#7ebfc2'}, 332: {'group': 0, 'well_id': 'L21', 'state': 'blank', 'colour': '#7ebfc2'}, 333: {'group': 0, 'well_id': 'M21', 'state': 'blank', 'colour': '#7ebfc2'}, 334: {'group': 0, 'well_id': 'N21', 'state': 'blank', 'colour': '#7ebfc2'}, 335: {'group': 0, 'well_id': 'O21', 'state': 'blank', 'colour': '#7ebfc2'}, 336: {'group': 0, 'well_id': 'P21', 'state': 'blank', 'colour': '#7ebfc2'}, 337: {'group': 0, 'well_id': 'A22', 'state': 'blank', 'colour': '#7ebfc2'}, 338: {'group': 0, 'well_id': 'B22', 'state': 'blank', 'colour': '#7ebfc2'}, 339: {'group': 0, 'well_id': 'C22', 'state': 'negative', 'colour': '#d20000'}, 340: {'group': 0, 'well_id': 'D22', 'state': 'blank', 'colour': '#7ebfc2'}, 341: {'group': 0, 'well_id': 'E22', 'state': 'blank', 'colour': '#7ebfc2'}, 342: {'group': 0, 'well_id': 'F22', 'state': 'blank', 'colour': '#7ebfc2'}, 343: {'group': 0, 'well_id': 'G22', 'state': 'blank', 'colour': '#7ebfc2'}, 344: {'group': 0, 'well_id': 'H22', 'state': 'blank', 'colour': '#7ebfc2'}, 345: {'group': 0, 'well_id': 'I22', 'state': 'negative', 'colour': '#d20000'}, 346: {'group': 0, 'well_id': 'J22', 'state': 'blank', 'colour': '#7ebfc2'}, 347: {'group': 0, 'well_id': 'K22', 'state': 'blank', 'colour': '#7ebfc2'}, 348: {'group': 0, 'well_id': 'L22', 'state': 'blank', 'colour': '#7ebfc2'}, 349: {'group': 0, 'well_id': 'M22', 'state': 'blank', 'colour': '#7ebfc2'}, 350: {'group': 0, 'well_id': 'N22', 'state': 'blank', 'colour': '#7ebfc2'}, 351: {'group': 0, 'well_id': 'O22', 'state': 'blank', 'colour': '#7ebfc2'}, 352: {'group': 0, 'well_id': 'P22', 'state': 'blank', 'colour': '#7ebfc2'}, 353: {'group': 0, 'well_id': 'A23', 'state': 'blank', 'colour': '#7ebfc2'}, 354: {'group': 0, 'well_id': 'B23', 'state': 'blank', 'colour': '#7ebfc2'}, 355: {'group': 0, 'well_id': 'C23', 'state': 'blank', 'colour': '#7ebfc2'}, 356: {'group': 0, 'well_id': 'D23', 'state': 'blank', 'colour': '#7ebfc2'}, 357: {'group': 0, 'well_id': 'E23', 'state': 'blank', 'colour': '#7ebfc2'}, 358: {'group': 0, 'well_id': 'F23', 'state': 'blank', 'colour': '#7ebfc2'}, 359: {'group': 0, 'well_id': 'G23', 'state': 'blank', 'colour': '#7ebfc2'}, 360: {'group': 0, 'well_id': 'H23', 'state': 'blank', 'colour': '#7ebfc2'}, 361: {'group': 0, 'well_id': 'I23', 'state': 'blank', 'colour': '#7ebfc2'}, 362: {'group': 0, 'well_id': 'J23', 'state': 'blank', 'colour': '#7ebfc2'}, 363: {'group': 0, 'well_id': 'K23', 'state': 'blank', 'colour': '#7ebfc2'}, 364: {'group': 0, 'well_id': 'L23', 'state': 'blank', 'colour': '#7ebfc2'}, 365: {'group': 0, 'well_id': 'M23', 'state': 'blank', 'colour': '#7ebfc2'}, 366: {'group': 0, 'well_id': 'N23', 'state': 'blank', 'colour': '#7ebfc2'}, 367: {'group': 0, 'well_id': 'O23', 'state': 'blank', 'colour': '#7ebfc2'}, 368: {'group': 0, 'well_id': 'P23', 'state': 'blank', 'colour': '#7ebfc2'}, 369: {'group': 0, 'well_id': 'A24', 'state': 'blank', 'colour': '#7ebfc2'}, 370: {'group': 0, 'well_id': 'B24', 'state': 'blank', 'colour': '#7ebfc2'}, 371: {'group': 0, 'well_id': 'C24', 'state': 'blank', 'colour': '#7ebfc2'}, 372: {'group': 0, 'well_id': 'D24', 'state': 'blank', 'colour': '#7ebfc2'}, 373: {'group': 0, 'well_id': 'E24', 'state': 'blank', 'colour': '#7ebfc2'}, 374: {'group': 0, 'well_id': 'F24', 'state': 'blank', 'colour': '#7ebfc2'}, 375: {'group': 0, 'well_id': 'G24', 'state': 'blank', 'colour': '#7ebfc2'}, 376: {'group': 0, 'well_id': 'H24', 'state': 'blank', 'colour': '#7ebfc2'}, 377: {'group': 0, 'well_id': 'I24', 'state': 'blank', 'colour': '#7ebfc2'}, 378: {'group': 0, 'well_id': 'J24', 'state': 'blank', 'colour': '#7ebfc2'}, 379: {'group': 0, 'well_id': 'K24', 'state': 'blank', 'colour': '#7ebfc2'}, 380: {'group': 0, 'well_id': 'L24', 'state': 'blank', 'colour': '#7ebfc2'}, 381: {'group': '2', 'well_id': 'M24', 'state': 'positive', 'colour': '#09ca0e'}, 382: {'group': 0, 'well_id': 'N24', 'state': 'blank', 'colour': '#7ebfc2'}, 383: {'group': 0, 'well_id': 'O24', 'state': 'blank', 'colour': '#7ebfc2'}, 384: {'group': 0, 'well_id': 'P24', 'state': 'blank', 'colour': '#7ebfc2'}}
    files = get_file_list(folder)
    save_location = config["folders"]["output"]
    mixed_up = True
    worklist_file = r"C:\Users\phch\OneDrive - Danmarks Tekniske Universitet\Mapper\Python_data\MolFormatic\worklist\procul\Worklist_procul_1_to_2_testPlates.txt"
    include_id = True
    bonus_layout = r"C:\Users\phch\OneDrive - Danmarks Tekniske Universitet\Mapper\Python_data\procul\procul_control_layout.xlsx"

    hit_threshold = {"hit_value": 1, "pH": 5.5, "time_limit": 1080}
    if include_id:
        translate_dict = _translate_dict_generator(bonus_layout)
    else:
        translate_dict = None
    compound_data = {}
    all_barcodes = []

    for file in files:
        if file.endswith(".xls"):
            file = xls_converter(file)
            all_data, well_row_col, well_type, barcode, date, data_style = multiscan_data_dict(file, plate_layout,
                                                                                               mixed_up)
        elif file.endswith(".txt"):
            file = csv_converter(file, "normal")
            all_data, well_row_col, well_type, barcode, date, data_style = multiscan_data_dict(file, plate_layout,
                                                                                               mixed_up)
        elif file.endswith(".xlsx"):
            all_data, well_row_col, well_type, barcode, date, data_style = multiscan_data_dict(file, plate_layout,
                                                                                               mixed_up)
        else:

            end = file.split(".")[-1]
            return "Error", "file formate is wrong for the raw data.\n" \
                            f"The system can't deal with {end}, only .xls, .xlsx or .txt"
        bio_sample_dict, all_destination_plates = bio_compound_info_from_worklist(config, [worklist_file])


        try:
            compound_data[barcode]
        except KeyError:
            compound_data[barcode] = {}

        name_indicator = data_style
        name_counter = 2
        run = True
        while run or name_counter > 9999:
            try:
                compound_data[barcode][name_indicator]
            except KeyError:
                compound_data[barcode][name_indicator] = {}
                run = False
            else:
                name_indicator = f"{name_indicator}_{name_counter}"
                name_counter += 1

        compound_data[barcode][name_indicator] = data_controller(config, barcode, data_style, plate_layout, all_data,
                                                                 well_type, bio_sample_dict, include_id, translate_dict,
                                                                 hit_threshold)
        if barcode not in all_barcodes:
            all_barcodes.append(barcode)


    # Report set-up
    report_setup = {"raw": True}
    assay_name = all_barcodes[0].split("_")[0]
    if len(all_barcodes) > 1:
        report_file_name = f"{assay_name}_{all_barcodes[0].split('_')[-1]}-{all_barcodes[-1].split('_')[-1]}_report"
    else:
        report_file_name = f"{assay_name}_{all_barcodes[0].split('_')[-1]}_report"
    save_location = f"{save_location}/{assay_name}"
    if not os.path.exists(save_location):
        os.mkdir(save_location)

    procul_report_controller(report_file_name, compound_data, save_location, report_setup, hit_threshold)


if __name__ == "__main__":
    testing()
